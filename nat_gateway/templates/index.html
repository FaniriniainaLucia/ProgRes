<!-- templates/index.html -->
<!DOCTYPE html>
<html>
<head>
  <title>Passerelle NAT</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
  <h2 class="mb-4">ðŸ”„ NAT Gateway Interface</h2>

  <form method="POST" class="card p-3 mb-4">
    <div class="row g-2">
      <div class="col-md-5">
        <label>Interface LAN</label>
        <select name="lan" class="form-select" required>
          {% for iface in interfaces %}
          <option value="{{ iface.name }}" {% if config.lan == iface.name %}selected{% endif %}>
            {{ iface.name }} - {{ iface.ip or "no IP" }}
          </option>
          {% endfor %}
        </select>
      </div>

      <div class="col-md-5">
        <label>Interface WAN</label>
        <select name="wan" class="form-select" required>
          {% for iface in interfaces %}
          <option value="{{ iface.name }}" {% if config.wan == iface.name %}selected{% endif %}>
            {{ iface.name }} - {{ iface.ip or "no IP" }}
          </option>
          {% endfor %}
        </select>
      </div>

      <div class="col-md-2 d-flex align-items-end">
        <button type="submit" class="btn btn-success w-100">DÃ©marrer NAT</button>
      </div>
    </div>
  </form>

  {% if config.status %}
  <div class="alert alert-success d-flex justify-content-between align-items-center">
    NAT actif entre <strong>{{ config.lan }}</strong> et <strong>{{ config.wan }}</strong> ({{ config.wan_ip }})
    <a href="/stop" class="btn btn-danger btn-sm">ArrÃªter</a>
  </div>
  {% else %}
  <div class="alert alert-warning">NAT inactif</div>
  {% endif %}

  <h4 class="mt-5">ðŸ“‹ Connexions Actives (Table NAT)</h4>
  <div id="nat-table">
    <!-- Cette zone sera mise Ã  jour dynamiquement -->
  </div>
</div>

<script>
// Actualise la table NAT toutes les 2 secondes
setInterval(() => {
  fetch("/nat_table")
    .then(res => res.text())
    .then(html => document.getElementById("nat-table").innerHTML = html);
}, 2000);
</script>
</body>
</html>
